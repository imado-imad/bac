<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathematics Exam 2024</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            overflow-x: hidden;
            touch-action: none;
            font-family: sans-serif;
        }
        
        .container {
            width: 100vw;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
        }
        
        .image-wrapper {
            position: relative;
            width: 100%;
            overflow: hidden;
            cursor: grab;
        }
        
        .image-wrapper.grabbing {
            cursor: grabbing;
        }
        
        img {
            display: block;
            width: 100%;
            height: auto;
            transform-origin: 0 0;
            user-select: none;
            -webkit-user-drag: none;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.2rem;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="image-wrapper" id="imageWrapper">
            <div class="loading">Loading image...</div>
            <img id="zoomImage" src="https://imado-imad.github.io/bac/images/2024-mathematics-exam.jpg" alt="2024 Mathematics Exam">
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const imageWrapper = document.getElementById('imageWrapper');
            const zoomImage = document.getElementById('zoomImage');
            let scale = 1;
            let posX = 0;
            let posY = 0;
            let lastX = 0;
            let lastY = 0;
            let isDragging = false;
            let loadingElement = document.querySelector('.loading');
            
            // Hide loading when image is loaded
            zoomImage.onload = function() {
                loadingElement.style.display = 'none';
            };
            
            // Handle errors
            zoomImage.onerror = function() {
                loadingElement.textContent = 'Error loading image';
            };
            
            // Double click zoom
            imageWrapper.addEventListener('dblclick', function(e) {
                e.preventDefault();
                
                // Get mouse position relative to image
                const rect = zoomImage.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                const mouseY = e.clientY - rect.top;
                
                // Calculate new scale
                const newScale = scale === 1 ? 2 : 1;
                
                // Calculate new position to zoom to/from center
                const deltaX = (mouseX / scale) * (1 - newScale);
                const deltaY = (mouseY / scale) * (1 - newScale);
                
                // Apply new transform
                scale = newScale;
                posX += deltaX;
                posY += deltaY;
                
                applyTransform();
            });
            
            // Mouse drag events
            imageWrapper.addEventListener('mousedown', function(e) {
                if (scale === 1) return; // Only drag when zoomed
                
                e.preventDefault();
                isDragging = true;
                lastX = e.clientX;
                lastY = e.clientY;
                imageWrapper.classList.add('grabbing');
            });
            
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                const dx = e.clientX - lastX;
                const dy = e.clientY - lastY;
                
                lastX = e.clientX;
                lastY = e.clientY;
                
                // Update position with constraints
                updatePosition(dx, dy);
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
                imageWrapper.classList.remove('grabbing');
            });
            
            // Touch events with Hammer.js
            const hammer = new Hammer(imageWrapper);
            hammer.get('pinch').set({ enable: true });
            hammer.get('pan').set({ direction: Hammer.DIRECTION_ALL });
            
            let initialScale = 1;
            
            hammer.on('pinchstart', function(e) {
                initialScale = scale;
            });
            
            hammer.on('pinch', function(e) {
                scale = initialScale * e.scale;
                applyTransform();
            });
            
            hammer.on('panstart', function(e) {
                if (scale === 1 && window.innerWidth <= 768) {
                    // Allow vertical panning when not zoomed on mobile
                    lastY = e.center.y;
                    return;
                }
                
                if (scale === 1) return;
                
                lastX = e.deltaX;
                lastY = e.deltaY;
            });
            
            hammer.on('pan', function(e) {
                if (scale === 1 && window.innerWidth <= 768) {
                    // Vertical panning only when not zoomed on mobile
                    const dy = e.center.y - lastY;
                    lastY = e.center.y;
                    updatePosition(0, dy);
                    return;
                }
                
                if (scale === 1) return;
                
                const dx = e.deltaX - lastX;
                const dy = e.deltaY - lastY;
                
                lastX = e.deltaX;
                lastY = e.deltaY;
                
                updatePosition(dx, dy);
            });
            
            function updatePosition(dx, dy) {
                // Calculate new position
                posX += dx / scale;
                posY += dy / scale;
                
                // Apply constraints
                const imgRect = zoomImage.getBoundingClientRect();
                const wrapperRect = imageWrapper.getBoundingClientRect();
                
                const maxX = Math.max(0, (imgRect.width * scale - wrapperRect.width) / scale);
                const maxY = Math.max(0, (imgRect.height * scale - wrapperRect.height) / scale);
                
                posX = Math.min(Math.max(posX, -maxX), 0);
                posY = Math.min(Math.max(posY, -maxY), 0);
                
                applyTransform();
            }
            
            function applyTransform() {
                zoomImage.style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`;
            }
            
            // Reset on window resize
            window.addEventListener('resize', function() {
                if (scale === 1) {
                    posX = 0;
                    posY = 0;
                    applyTransform();
                } else {
                    // Recalculate constraints
                    updatePosition(0, 0);
                }
            });
        });
    </script>
</body>
</html>
